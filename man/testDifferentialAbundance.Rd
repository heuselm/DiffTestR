% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/testDifferentialAbundance.R
\name{testDifferentialAbundance}
\alias{testDifferentialAbundance}
\title{Test Differential Protein Expression in MS proteomics data}
\usage{
testDifferentialAbundance(
  data,
  normalize_data = TRUE,
  normalization_function = limma::normalizeQuantiles,
  condition_1 = NULL,
  condition_2 = NULL,
  min_n_obs = 4,
  imp_percentile = 0.001,
  imp_sd = 0.2,
  plot_pdf = TRUE,
  write_tsv_tables = TRUE,
  target_protein = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{Either a qdata object (recommended) OR a path to a data file
(will attempt to import). If a data.table/data.frame is provided, a
deprecation warning is shown.}

\item{normalize_data}{Whether or not data is scaled/normalized before
differential testing. In some cases it might be preferable not to scale
the datasets, e.g. when comparing pulldowns vs. input samples!
Defaults to TRUE.}

\item{normalization_function}{Normalization function to use that transforms
a matrix of quantities where columns are samples and rows are analytes.
Defaults to limma::normalizeQuantiles, but can be replaced with any such
function. Try limma::normalizeVSN or limma::normalizeMedianValues.}

\item{condition_1}{First condition for the differential comparison. By
default it is guessed from unique conditions in the qdata object.}

\item{condition_2}{Second condition for the differential comparison. By
default it is guessed from unique conditions in the qdata object.}

\item{min_n_obs}{Minimum number of observations per precursor (number of
runs it was identified in) to keep it in the analysis (default: 4)}

\item{imp_percentile}{Percentile of the total distribution of values on
which the random distribution for sampling will be centered (default: 0.001)}

\item{imp_sd}{Standard deviation of the normal distribution from which
values are sampled to impute missing values (default: 0.2)}

\item{plot_pdf}{Document processing steps in a series of pdf graphs
(default: TRUE)}

\item{write_tsv_tables}{Write out final quant table with differential
expression testing results (default: TRUE)}

\item{target_protein}{Optional string with protein identifier to highlight
in volcano plots}

\item{verbose}{Logical, whether to print progress messages during analysis
(default: TRUE)}
}
\value{
A ddata object (S3 class) containing differential expression results:
\itemize{
\item data_source: Source file path
\item comparison: String describing the comparison (e.g., "A/B")
\item conditions: Named list with condition_1 and condition_2
\item diffExpr_result_dt: Result table with intensities and statistics
\item mat_quant_log2_qnorm_imp_minObs: Processed matrix (log2, normalized,
imputed, filtered)
\item mat_quant_log2_qnorm: Log2 normalized matrix
\item mat_quant_log2: Log2 transformed matrix
\item mat_quant: Raw intensity matrix
\item study_design: Study design table
\item candidates_condition1: Proteins higher in condition 1
\item candidates_condition2: Proteins higher in condition 2
\item summary_stats: Summary statistics of the analysis
}
}
\description{
Test Differential Protein Expression in MS proteomics data
starting from the precursor level. This function now primarily accepts qdata
objects from importFromDIANN() or importFromTables().
}
\details{
This function performs the following steps:
\enumerate{
\item Log2 transformation
\item Optional normalization (quantile normalization by default)
\item Filtering based on minimum observations
\item Missing value imputation
\item Precursor-level t-tests
\item Protein-level rollup and multiple testing correction
}

The returned ddata object has plot() and summary() methods for
visualization and result exploration.
}
\examples{
\dontrun{
# Recommended workflow
qdata <- importFromTables("data.tsv", study_design = "design.txt")
ddata <- testDifferentialAbundance(qdata)

# Interactive volcano plot
plot(ddata, interactive = TRUE)

# Static PDF volcano plot
plot(ddata, interactive = FALSE)

# Summary
summary(ddata)
}

}
\author{
Moritz Heusel
}
