% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assessDataQuality.R
\name{assessDataQuality}
\alias{assessDataQuality}
\title{Assess Proteomics Data Quality}
\usage{
assessDataQuality(
  data_matrix,
  study_design,
  cv_threshold = 0.3,
  verbose = TRUE
)
}
\arguments{
\item{data_matrix}{Numeric matrix of log2-transformed intensities with
precursors/peptides in rows and samples in columns}

\item{study_design}{Data.table or data.frame with columns 'filename',
'condition', and 'replicate'. Rownames or 'filename' column must match
column names in data_matrix}

\item{cv_threshold}{Threshold for flagging outlier replicates based on
CV improvement upon removal (default: 0.3 = 30\% improvement)}

\item{verbose}{Logical, whether to print progress messages (default: TRUE)}
}
\value{
A list with the following components:
\itemize{
\item cv_stats: CV statistics per condition
\item cv_loo_analysis: Leave-one-out CV analysis results
\item outlier_replicates: Data.table of flagged outlier replicates
\item missing_stats: Missing value analysis
\item dynamic_range: Min, max, and range of intensities
\item replicate_correlations: Correlation matrix within conditions
}
}
\description{
Comprehensive quality assessment of proteomics data including
coefficient of variation analysis, missing value summaries, dynamic range,
and replicate correlation metrics. Includes leave-one-out CV analysis to
identify outlier replicates.
}
\details{
The leave-one-out CV analysis calculates the coefficient of variation for
each condition with all replicates, then recalculates CV after removing
each replicate individually. If removing a replicate improves the median
CV by more than cv_threshold (default 30\%), that replicate is flagged as
a potential outlier.
}
\examples{
\dontrun{
data(DiffTestR_example_data_wide)
data(DiffTestR_example_study_design)

# Convert to matrix
data_mat <- as.matrix(DiffTestR_example_data_wide[, 4:11])
rownames(data_mat) <- DiffTestR_example_data_wide$Precursor.Id

# Assess quality
qc <- assessDataQuality(data_mat, DiffTestR_example_study_design)

# View outlier replicates
print(qc$outlier_replicates)

# Plot CV distributions
plot(qc$cv_stats$cv_distribution)
}

}
\author{
Moritz Heusel
}
