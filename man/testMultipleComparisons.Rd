% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/testMultipleComparisons.R
\name{testMultipleComparisons}
\alias{testMultipleComparisons}
\title{Test Multiple Differential Abundance Comparisons}
\usage{
testMultipleComparisons(
  input_dt = "path/to/DIANN_matrix.tsv",
  protein_group_annotation = NULL,
  study_design = "path/to/Study_design_filled.tsv",
  comparisons = NULL,
  normalize_data = TRUE,
  normalization_function = limma::normalizeQuantiles,
  min_n_obs = 4,
  imp_percentile = 0.001,
  imp_sd = 0.2,
  output_dir = NULL,
  plot_pdf = TRUE,
  write_tsv_tables = TRUE,
  target_protein = "O08760",
  stop_on_error = FALSE,
  verbose = TRUE
)
}
\arguments{
\item{input_dt}{Input data table either in tsv/txt format or already in R as data.table or data.frame with the following columns:
\itemize{
\item Protein.Group: Semicolon-separated Uniprot IDs (or similar, as long as it matches)
\item Precursor.Id: Unique Precursor Id for which the quantitative values are contained
\item "filename": The file names of the MS raw data, must be identical to the entries in study_design$filename
}
Note: The data will be log2-transformed internally.}

\item{protein_group_annotation}{Protein annotation table with columns Protein.Group and Protein.Names (and others if desired)
that will be used to annotate the results. By default it is assumed to be a subset of and and an attempt will be made
to extract it from the input_dt.}

\item{study_design}{Study design in tab-separated .txt with mandatory columns:
\itemize{
\item filename: Must match quantitative data-containing column headers in the input_dt
\item condition: String, biological condition (e.g. "treated" and "untreated")
\item replicate: Replicate number (integer). Minimally 3 replicates are needed per condition for this type of analysis.
}}

\item{comparisons}{Optional list of comparisons to perform. Each element should be a named list with
\code{condition_1} and \code{condition_2}. If NULL (default), all pairwise comparisons will be auto-generated.
Example: \code{list(list(condition_1 = "A", condition_2 = "B"), list(condition_1 = "A", condition_2 = "C"))}}

\item{normalize_data}{Whether or not data is scaled/normalized before differential testing. In some cases
it might be preferable not to scale the datasets, e.g. when comparing pulldowns vs. input samples! Defaults to TRUE.}

\item{normalization_function}{Normalization function to use that transforms a matrix of quantities where columns are
samples and rows are analytes. Defaults to limma:normalizeQuantiles, but can be replaced with any such function. You may want
to try limma::normalizeVSN or limma::normalizeMedianValues.}

\item{min_n_obs}{Minimum number of observations per precursor (number of runs it was identified in)
in order to keep in in the analysis}

\item{imp_percentile}{Percentile of the total distribution of values on which the random
distribution for sampling will be centered}

\item{imp_sd}{standard deviation of the normal distribution from which values are sampled to impute missing values}

\item{output_dir}{Output directory for results. If NULL, uses current working directory. Each comparison
will be saved in a subdirectory named "condition1_vs_condition2"}

\item{plot_pdf}{Document processing steps in a string of pdf graphs for each comparison}

\item{write_tsv_tables}{Write out final quant table with differential expression testing results}

\item{target_protein}{Optional string with protein identifier to highlight in volcano plots}

\item{stop_on_error}{Logical, whether to stop on first error (TRUE) or continue with remaining
comparisons (FALSE, default). When FALSE, errors are logged in the error_log element.}

\item{verbose}{Logical, whether to print progress messages during analysis (default: TRUE)}
}
\value{
A multiDiffExpr object (list) containing:
\itemize{
\item individual_results: List of diffExpr objects, one per comparison
\item combined_results_dt: Aggregated data.table with results from all comparisons
\item comparisons: Specification of comparisons performed
\item n_comparisons: Total number of comparisons attempted
\item n_successful: Number of comparisons completed successfully
\item error_log: Data.table with any errors encountered (NULL if all successful)
\item output_dir: Directory where results were saved
}
}
\description{
Perform differential abundance testing for multiple pairwise comparisons.
This function either accepts explicit comparison pairs or auto-generates all pairwise
comparisons from unique conditions in the study design. Results are aggregated and
returned as a structured multiDiffExpr object.
}
\examples{
\dontrun{
# Auto-generate all pairwise comparisons
result <- testMultipleComparisons(
  input_dt = "path/to/DIANN_matrix.tsv",
  study_design = "path/to/Study_design.tsv",
  output_dir = "multi_comparison_results"
)

# Explicit comparisons
my_comparisons <- list(
  list(condition_1 = "Treatment_A", condition_2 = "Control"),
  list(condition_1 = "Treatment_B", condition_2 = "Control")
)
result <- testMultipleComparisons(
  input_dt = data_dt,
  study_design = design_dt,
  comparisons = my_comparisons
)
}

}
\author{
Moritz Heusel
}
